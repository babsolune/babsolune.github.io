!function(a){a.fn.extend({dndfiles:function(e){function s(a,e){if(0==a)return"0 Bytes";var s=e||2,l=Math.floor(Math.log(a)/Math.log(1024));return parseFloat((a/Math.pow(1024,l)).toFixed(s))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][l]}param=a.extend({filesNbr:".files-nbr",filesList:".ulist",multiple:!1,maxFileSize:"500000000",maxFilesSize:"-1",maxWidth:"-1",maxHeight:"-1",allowedExtensions:["jpg","jpeg","png","webp","gif","svg"],warningText:"Upload have been disabled because of bad file:",warningExtension:"bad extension <br />",warningFileSize:"Too large file <br />",warningFilesNbr:"The size of the allocated space is exceeded <br />",warningFilesDim:"The height or width of the picture exceeds the maximum allowed <br />"},e);var l,i,n,d,t,r,p=a(this);param.multiple&&(p.attr("multiple","multiple"),a(param.filesNbr).html("0")),p.on("dragover mouseover",function(){p.closest(".dnd-dropzone").addClass("dragover")}),p.on("dragleave drop mouseleave",function(){p.closest(".dnd-dropzone").removeClass("dragover")}),p.parent().on("change",function(e){param.multiple&&p.closest(".dnd-area").find(param.filesNbr).empty(),p.closest(".dnd-area").siblings(param.filesList).empty(),p.closest("form").find('button[type="submit"]').prop("disabled",!1),p.closest(".dnd-area").find("label .d-block").html(""),p.closest(".dnd-area").find("label .d-block").removeClass("message-helper bgc warning small"),p.closest(".dnd-area").find(".upload-help").removeClass(" warning");var o=p[0].files.length,c=0,f=p[0].files,m="";p.attr("multiple")&&p.closest(".dnd-area").find(param.filesNbr).append(o),o>0&&a(".clear-list").css("display","inline-block");for(var b=0;o>b;b++){var g="";if(n=f[b].name,i=f[b].size,d=f[b].type,l=(l=n.replace(/^.*\./,""))==n?"":l.toLowerCase(),0===d.indexOf("image/")){var u=f[b],h=new Image;h.onload=function(){t=this.width,r=this.height,(param.maxWidth>-1&&t>param.maxWidth||param.maxHeight>-1&&r>param.maxHeight)&&(p.closest("form").find('button[type="submit"]').attr("disabled","disabled"),p.closest(".dnd-area").find(".upload-help").addClass(" warning"),p.closest(".dnd-area").find("label .d-block").addClass("message-helper bgc warning small").append(param.warningFileDim))},h.src=URL.createObjectURL(u)}c+=i,(-1===param.allowedExtensions.indexOf(l)||i>param.maxFileSize||c>param.maxFilesSize&&param.maxFilesSize>-1)&&(g="warning",p.closest("form").find('button[type="submit"]').attr("disabled","disabled")),-1===param.allowedExtensions.indexOf(l)&&p.closest(".dnd-area").find("label .d-block").append('<span class="filename">'+n+"</span>",param.warningExtension),i>param.maxFileSize&&p.closest(".dnd-area").find("label .d-block").append('<span class="filename">'+n+"</span>",param.warningFileSize),0===d.indexOf("image/")?m+='<li class="'+g+'" data-file="'+n+'"><img src="'+URL.createObjectURL(f[b])+'" /> '+n+"&nbsp;<sup>"+s(i)+'</sup><span class="fa fa-times-circle fa-lg close-item"></span></li>':0===d.indexOf("audio/")?m+='<li class="'+g+'" data-file="'+n+'"><i class="far fa-file"></i> '+n+"&nbsp;<sup>"+s(i)+'</sup><span class="fa fa-times-circle fa-lg close-item"></span></li>':0===d.indexOf("video/")?m+='<li class="'+g+'" data-file="'+n+'"><i class="far fa-file"></i> '+n+"&nbsp;<sup>"+s(i)+'</sup><span class="fa fa-times-circle fa-lg close-item"></span></li>':0===d.indexOf("application/zip")?m+='<li class="'+g+'" data-file="'+n+'"><i class="far fa-file-archive"></i> '+n+"&nbsp;<sup>"+s(i)+'</sup><span class="fa fa-times-circle fa-lg close-item"></span></li>':0===d.indexOf("application/pdf")?m+='<li class="'+g+'" data-file="'+n+'"><i class="far fa-file-pdf"></i> '+n+"&nbsp;<sup>"+s(i)+'</sup><span class="fa fa-times-circle fa-lg close-item"></span></li>':m+='<li class="'+g+'" data-file="'+n+'"><i class="far fa-file"></i> '+n+"&nbsp;<sup>"+s(i)+'</sup><span class="fa fa-times-circle fa-lg close-item"></span></li>'}a(p).closest(".dnd-area").siblings(param.filesList).append(m),p.closest("form").find('button[type="submit"]').attr("disabled")&&(p.closest(".dnd-area").find(".upload-help").addClass(" warning"),p.closest(".dnd-area").find("label .d-block").addClass("message-helper bgc warning small"),p.closest(".dnd-area").find("label .d-block").prepend(param.warningText)),c>param.maxFilesSize&&param.maxFilesSize>-1&&p.closest(".dnd-area").find("label .d-block").append(param.warningFilesNbr),a(param.filesList).find(".close-item").each(function(){a(this).on("click",function(){var e=a('.ulist li:not([value="0"])').length;a(this).parent().empty().val("").hide();var s=e-1;a(param.filesNbr).empty().append(s)})}),a(".clear-list").on("click",function(a){a.preventDefault(),p.val(""),p.closest(".dnd-area").find(param.filesNbr).html("0"),p.closest(".dnd-area").siblings(param.filesList).empty(),p.closest("form").find('button[type="submit"]').prop("disabled",!1),p.closest(".dnd-area").find("label .d-block").html(""),p.closest(".dnd-area").find("label .d-block").removeClass("message-helper bgc warning small"),p.closest(".dnd-area").find(".upload-help").removeClass(" warning"),p.closest(".dnd-area").find(".clear-list").css("display","none")})})}})}(jQuery);
